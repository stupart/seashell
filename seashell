#!/bin/bash

# Resolve symlinks to get actual script location
SCRIPT="$0"
while [ -L "$SCRIPT" ]; do
    SCRIPT_DIR="$(cd "$(dirname "$SCRIPT")" && pwd)"
    SCRIPT="$(readlink "$SCRIPT")"
    [[ $SCRIPT != /* ]] && SCRIPT="$SCRIPT_DIR/$SCRIPT"
done
SCRIPT_DIR="$(cd "$(dirname "$SCRIPT")" && pwd)"
cd "$SCRIPT_DIR"

# Find bun - check PATH first, then common install locations
if command -v bun &> /dev/null; then
    BUN="bun"
elif [ -x "$HOME/.bun/bin/bun" ]; then
    BUN="$HOME/.bun/bin/bun"
elif [ -x "/opt/homebrew/bin/bun" ]; then
    BUN="/opt/homebrew/bin/bun"
elif [ -x "/usr/local/bin/bun" ]; then
    BUN="/usr/local/bin/bun"
else
    echo "Error: bun not found. Install it: curl -fsSL https://bun.sh/install | bash"
    exit 1
fi

exec "$BUN" run src/cli.tsx
